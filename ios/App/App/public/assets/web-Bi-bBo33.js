import{W as p,C as S,H as f,d as w}from"./index-Dh2fYw-z.js";class B extends p{async stopAndHideScanner(){console.log(window.OSBarcodeWebScanner),window.OSBarcodeWebScanner&&(await window.OSBarcodeWebScanner.stop(),window.OSBarcodeWebScanner=null),document.getElementById("cap-os-barcode-scanner-container-dialog").style.display="none"}buildScannerElement(){if(document.getElementById("cap-os-barcode-scanner-container")){document.getElementById("cap-os-barcode-scanner-container").className="scanner-container-display";return}const e=document.body.appendChild(document.createElement("div"));e.id="cap-os-barcode-scanner-container";const o=document.createElement("div");o.id="cap-os-barcode-scanner-container-dialog",o.className="scanner-dialog";const c=document.createElement("div");c.className="scanner-dialog-inner";const a=document.createElement("span");a.className="close-button",a.innerHTML="&times;",c.appendChild(a);const r=document.createElement("p");r.innerHTML="&nbsp;",c.appendChild(r);const n=document.createElement("div");n.className="scanner-container-full-width",n.id="cap-os-barcode-scanner-container-scanner",c.appendChild(n),o.appendChild(c),e.appendChild(o),a.onclick=this.stopAndHideScanner}async scanBarcode(e){return this.buildScannerElement(),document.getElementById("cap-os-barcode-scanner-container-dialog").style.display="block",new Promise((o,c)=>{var a,r;const n={facingMode:e.cameraDirection===1?"environment":"user",hasScannerButton:!1,scanButton:e.scanButton===void 0?!1:e.scanButton,showScanLine:!1,scanInstructions:e.scanInstructions?e.scanInstructions:"",orientation:e.scanOrientation?e.scanOrientation:S.PORTRAIT,showCameraSelection:!((a=e.web)===null||a===void 0)&&a.showCameraSelection?e.web.showCameraSelection:!1,typeHint:e.hint===17?void 0:e.hint,scannerFPS:!((r=e.web)===null||r===void 0)&&r.scannerFPS?e.web.scannerFPS:50},i=document.getElementById("cap-os-barcode-scanner-container-scanner");if(!i)throw new Error("Scanner Element is required for web");window.OSBarcodeWebScanner=new f(i.id,{formatsToSupport:n.typeHint!==void 0?[n.typeHint]:void 0,verbose:void 0});const m={fps:n.scannerFPS,qrbox:i.getBoundingClientRect().width*(9/16)-10,aspectRatio:16/9,videoConstraints:{focusMode:"continuous",height:{min:576,ideal:1920},deviceId:void 0,facingMode:n.facingMode}},u=(t,l)=>{var d,s;this.stopAndHideScanner(),o({ScanResult:t,format:(s=(d=l.result.format)===null||d===void 0?void 0:d.format)!==null&&s!==void 0?s:w.ALL})},b=t=>{["NotFoundException","No barcode or QR code detected","No MultiFormat Readers were able to detect the code"].find(d=>t.indexOf(d)!==-1)||(this.stopAndHideScanner(),console.error(`[Scanner Web Error] ${t}`),c(t))};window.OSBarcodeWebScanner.start({facingMode:n.facingMode},m,u,b)})}}export{B as CapacitorBarcodeScannerWeb};
